{"version":3,"file":"baza-contentmeter.js","sources":["../src/Utilities.js","../src/ContentMeter.js"],"sourcesContent":["class Utilities {\r\n  static getDOMElement( selector ) {\r\n    let element = null;\r\n\r\n    if ( typeof selector === 'string'\r\n      && selector.indexOf( '#' ) !== -1\r\n      && selector.indexOf( '#' ) === 0\r\n    ) {\r\n      element = document.getElementById( selector.slice( 1 ) );\r\n\r\n    } else if ( typeof selector === 'object'\r\n      && selector.nodeType !== undefined\r\n      && selector.length === undefined\r\n    ) {\r\n      element = selector;\r\n    }\r\n\r\n    return element;\r\n  }\r\n\r\n  static createDOMElement( element, className, parent, callback ) {\r\n    const DOMElement = document.createElement( element );\r\n    DOMElement.classList.add( className );\r\n\r\n    if ( parent ) {\r\n      parent.appendChild( DOMElement );\r\n    }\r\n\r\n    if ( callback ) {\r\n      callback( DOMElement );\r\n    }\r\n\r\n    return DOMElement;\r\n  }\r\n\r\n  static getDocScrolltop() {\r\n    return document.documentElement.scrollTop || document.body.scrollTop;\r\n  }\r\n\r\n  static limitTheNumber( theNumber, min, max ) {\r\n    return ( theNumber > min ) ? ( ( theNumber < max ) ? theNumber : max ) : min;\r\n  }\r\n}\r\n\r\nexport default Utilities;\r\n","import Utilities from './Utilities.js';\r\n\r\nclass ContentMeter {\r\n  constructor( barSelector, contentSelector ) {\r\n    this.barSelector = barSelector;\r\n    this.contentSelector = contentSelector;\r\n\r\n    this.init();\r\n  }\r\n\r\n  updateClasses() {\r\n    if ( Utilities.getDocScrolltop() > ( this.content.height + this.content.offset )\r\n    || ( Utilities.getDocScrolltop() + this.content.visibleHeight ) < this.content.offset ) {\r\n\r\n      this.barContainer.classList.add( 'js-invisible' );\r\n    } else {\r\n      this.barContainer.classList.remove( 'js-invisible' );\r\n    }\r\n  }\r\n\r\n  getBarWidth() {\r\n    let barW = 0;\r\n    if ( !this.content ) {\r\n      this.readContentDimensions();\r\n    }\r\n\r\n    barW = (\r\n      ( this.content.selfScrolled ? this.contentContainer.scrollTop : Utilities.getDocScrolltop() )\r\n      + this.content.barBasicVal\r\n    ) / this.content.height * 100;\r\n\r\n    return Utilities.limitTheNumber( barW, 0, 100 );\r\n  }\r\n\r\n  setBarWidth() {\r\n    this.bar.style.width = `${this.getBarWidth()}%`;\r\n  }\r\n\r\n  setCounterValue() {\r\n    this.counter.textContent = Math.ceil( this.getBarWidth() );\r\n  }\r\n\r\n  readContentDimensions() {\r\n    this.content = this.content || {};\r\n\r\n    this.content.selfScrolled  = ( this.contentContainer.scrollHeight > this.contentContainer.clientHeight );\r\n\r\n    this.content.height        = this.contentContainer.scrollHeight;\r\n    this.content.visibleHeight = Math.min( window.innerHeight, this.contentContainer.clientHeight );\r\n    this.content.offset        = this.content.selfScrolled ? 0 : this.contentContainer.offsetTop;\r\n    this.content.barBasicVal   = this.content.offset * ( -1 ) + this.content.visibleHeight;\r\n\r\n    console.log( this.content );\r\n  }\r\n\r\n  bindUIEvents() {\r\n    const scrollTarget = this.content.selfScrolled ? this.contentContainer : window;\r\n    scrollTarget.addEventListener( 'scroll', () => {\r\n      this.setBarWidth();\r\n      this.setCounterValue();\r\n    } );\r\n\r\n    window.addEventListener( 'scroll', () => {\r\n      return this.updateClasses();\r\n    } );\r\n    window.addEventListener( 'resize', () => {\r\n      this.readContentDimensions();\r\n      this.setBarWidth();\r\n      this.setCounterValue();\r\n      this.updateClasses();\r\n    } );\r\n  }\r\n\r\n  createMeter() {\r\n    Utilities.createDOMElement(\r\n      'div', 'baza-contentmeter__bar', this.barContainer, ( element ) => {\r\n        this.bar = element;\r\n        this.setBarWidth();\r\n      }\r\n    );\r\n\r\n    Utilities.createDOMElement(\r\n      'div', 'baza-contentmeter__counter', this.barContainer, ( element ) => {\r\n        this.counter = element;\r\n        this.setCounterValue();\r\n      }\r\n    );\r\n\r\n    this.updateClasses();\r\n    this.bindUIEvents();\r\n  }\r\n\r\n  init() {\r\n    this.barContainer = Utilities.getDOMElement( this.barSelector );\r\n    this.contentContainer = Utilities.getDOMElement( this.contentSelector );\r\n\r\n    if ( this.barContainer !== null && this.contentContainer !== null ) {\r\n      this.readContentDimensions();\r\n      this.createMeter();\r\n    } else {\r\n      throw new Error( 'Wrong selectors or given selectors match no elements.' );\r\n    }\r\n  }\r\n}\r\n\r\nexport default ContentMeter;\r\n"],"names":["Utilities","selector","element","indexOf","document","getElementById","slice","undefined","nodeType","length","className","parent","callback","DOMElement","createElement","classList","add","appendChild","documentElement","scrollTop","body","theNumber","min","max","ContentMeter","barSelector","contentSelector","init","getDocScrolltop","this","content","height","offset","visibleHeight","barContainer","remove","barW","readContentDimensions","selfScrolled","contentContainer","barBasicVal","limitTheNumber","bar","style","width","getBarWidth","counter","textContent","Math","ceil","scrollHeight","clientHeight","window","innerHeight","offsetTop","log","addEventListener","setBarWidth","setCounterValue","_this","updateClasses","createDOMElement","bindUIEvents","getDOMElement","Error","createMeter"],"mappings":"8kBAAMA,wHACkBC,MAChBC,GAAU,WAEW,gBAAbD,IACPA,EAASE,QAAS,QAAW,GACD,IAA5BF,EAASE,QAAS,OAEXC,SAASC,eAAgBJ,EAASK,MAAO,IAErB,qBAAbL,sBAAAA,KACQM,SAAtBN,EAASO,UACWD,SAApBN,EAASQ,WAEFR,GAGLC,2CAGgBA,EAASQ,EAAWC,EAAQC,MAC7CC,GAAaT,SAASU,cAAeZ,YAChCa,UAAUC,IAAKN,GAErBC,KACIM,YAAaJ,GAGjBD,KACOC,GAGLA,kDAIAT,UAASc,gBAAgBC,WAAaf,SAASgB,KAAKD,iDAGtCE,EAAWC,EAAKC,SAC5BF,GAAYC,EAAYD,EAAYE,EAAQF,EAAYE,EAAQD,WCtCvEE,mCACSC,EAAaC,+BACnBD,YAAcA,OACdC,gBAAkBA,OAElBC,mEAIA3B,UAAU4B,kBAAsBC,KAAKC,QAAQC,OAASF,KAAKC,QAAQE,QACnEhC,UAAU4B,kBAAoBC,KAAKC,QAAQG,cAAkBJ,KAAKC,QAAQE,YAExEE,aAAanB,UAAUC,IAAK,qBAE5BkB,aAAanB,UAAUoB,OAAQ,yDAKlCC,GAAO,QACLP,MAAKC,cACJO,4BAIHR,KAAKC,QAAQQ,aAAeT,KAAKU,iBAAiBpB,UAAYnB,UAAU4B,mBACxEC,KAAKC,QAAQU,aACbX,KAAKC,QAAQC,OAAS,IAEnB/B,UAAUyC,eAAgBL,EAAM,EAAG,gDAIrCM,IAAIC,MAAMC,MAAWf,KAAKgB,iEAI1BC,QAAQC,YAAcC,KAAKC,KAAMpB,KAAKgB,oEAItCf,QAAUD,KAAKC,iBAEfA,QAAQQ,aAAkBT,KAAKU,iBAAiBW,aAAerB,KAAKU,iBAAiBY,kBAErFrB,QAAQC,OAAgBF,KAAKU,iBAAiBW,kBAC9CpB,QAAQG,cAAgBe,KAAK1B,IAAK8B,OAAOC,YAAaxB,KAAKU,iBAAiBY,mBAC5ErB,QAAQE,OAAgBH,KAAKC,QAAQQ,aAAe,EAAIT,KAAKU,iBAAiBe,eAC9ExB,QAAQU,YAAgBX,KAAKC,QAAQE,QAAY,EAAMH,KAAKC,QAAQG,sBAEjEsB,IAAK1B,KAAKC,4DAIGD,KAAKC,QAAQQ,aAAeT,KAAKU,iBAAmBa,QAC5DI,iBAAkB,SAAU,aAClCC,gBACAC,2BAGAF,iBAAkB,SAAU,iBAC1BG,GAAKC,yBAEPJ,iBAAkB,SAAU,aAC5BnB,0BACAoB,gBACAC,oBACAE,6EAKGC,iBACR,MAAO,yBAA0BhC,KAAKK,aAAc,SAAEhC,KAC/CwC,IAAMxC,IACNuD,0BAICI,iBACR,MAAO,6BAA8BhC,KAAKK,aAAc,SAAEhC,KACnD4C,QAAU5C,IACVwD,yBAIJE,qBACAE,sDAIA5B,aAAelC,UAAU+D,cAAelC,KAAKJ,kBAC7Cc,iBAAmBvC,UAAU+D,cAAelC,KAAKH,iBAE3B,OAAtBG,KAAKK,cAAmD,OAA1BL,KAAKU,sBAIhC,IAAIyB,OAAO,8DAHZ3B,6BACA4B"}